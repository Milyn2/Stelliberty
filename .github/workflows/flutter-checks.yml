name: Flutter ä»£ç æ£€æŸ¥

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  flutter-checks:
    name: ${{ matrix.os }}
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v6

      - name: é…ç½® Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: stable
          cache: false

      - name: å®‰è£… Flutter ä¾èµ–
        run: flutter pub get

      - name: ç”Ÿæˆ Rust æ¡¥æ¥ä»£ç 
        run: cargo install rinf_cli && rinf gen

      - name: ç”Ÿæˆå¤šè¯­è¨€æ–‡ä»¶
        run: dart run slang

      - name: æ£€æŸ¥ Dart ä»£ç æ ¼å¼
        run: |
          echo "ğŸ” æ£€æŸ¥ Dart ä»£ç æ ¼å¼..."
          if ! dart format --output=none --set-exit-if-changed .; then
            echo ""
            echo "âŒ Dart ä»£ç æ ¼å¼ä¸è§„èŒƒï¼"
            echo ""
            echo "è¯·åœ¨æœ¬åœ°è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¿®å¤ï¼š"
            echo "  dart format ."
            echo ""
            exit 1
          fi
          echo "âœ… Dart ä»£ç æ ¼å¼æ£€æŸ¥é€šè¿‡"

      - name: è¿è¡Œ Flutter é™æ€åˆ†æ
        run: flutter analyze